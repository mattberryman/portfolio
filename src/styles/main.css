/* ============================================================
   FONT FACES — self-hosted Equity (Matthew Butterick)
   ============================================================ */
@font-face {
  font-family: 'Equity';
  src: url('/fonts/equity_a_regular.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: 'Equity';
  src: url('/fonts/equity_a_italic.woff2') format('woff2');
  font-weight: 400;
  font-style: italic;
  font-display: swap;
}
@font-face {
  font-family: 'Equity';
  src: url('/fonts/equity_a_bold.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: 'Concourse';
  src: url('/fonts/concourse_6_regular.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Concourse Caps';
  src: url('/fonts/concourse_3_caps_regular.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@layer base, typography, layout, components, utilities, responsive;

/* ============================================================
   DESIGN SYSTEM — custom properties used as design tokens.
   To add a new article card: copy an existing .article-card div in index.html.
   To add a new project: copy an existing .project-card div in index.html.
   No new CSS required for either.
   ============================================================ */

@layer base {
  :root {
    /* Fonts */
    --font: 'Equity', Georgia, 'Times New Roman', serif;
    --font-nav: 'Concourse', 'Equity', Helvetica, Arial, sans-serif;
    --font-nav-caps: 'Concourse Caps', 'Concourse', Helvetica, Arial, sans-serif;

    /* Type scale — Butterick: sizes by eye, not modular ratio */
    --body: 1.5625rem; /* 25px — body text, hero description */
    --small: 1.25rem; /* 20px — nav links, card summaries, footer */
    --smaller: 1.0625rem; /* 17px — card labels, project tags */
    --h1: 1.9375rem; /* 31px — hero tagline, slide headings */
    --h2: 1.75rem; /* 28px — section headings */
    --h3: 1.5625rem; /* 25px — card headings (bold differentiates from body) */

    /* Line heights */
    --lh-body: 1.4; /* 120–145% of point size per Butterick */
    --lh-heading: 1.25;

    /* Palette — dark grey, not black, per Butterick for screen reading */
    --ink: #333;
    --ink-light: #666;
    --ink-lighter: #999;
    --surface: #faf9f7;
    --surface-elevated: #ffffff;
    --surface-subtle: #f0efeb;
    --accent: #5b4a8a;
    --accent-light: #7b6aaa;
    --accent-wash: rgba(91, 74, 138, 0.06);
    --accent-wash-hover: rgba(91, 74, 138, 0.1);
    --border: rgba(51, 51, 51, 0.08);
    --border-strong: rgba(51, 51, 51, 0.14);
    --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.03);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.06), 0 1px 3px rgba(0, 0, 0, 0.04);
    --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.08), 0 4px 12px rgba(0, 0, 0, 0.04);

    /* Spacing — 8px base */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.5rem;
    --space-6: 2rem;
    --space-8: 3rem;
    --space-10: 4rem;
    --space-12: 5rem;
    --space-16: 8rem;
    --space-20: 10rem;

    /* Layout */
    --max-width: 72rem;
    --content-width: 42rem;
    --radius: 8px;
    --radius-lg: 12px;
    --transition: 180ms ease;
  }

  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  html {
    font-size: 16px;
    scroll-behavior: smooth;
  }

  body {
    font-family: var(--font);
    font-size: var(--body);
    color: var(--ink);
    background: var(--surface);
    line-height: var(--lh-body);
    text-rendering: optimizeLegibility;
    font-feature-settings:
      'liga' 1,
      'kern' 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
  }

  img {
    max-width: 100%;
    display: block;
  }
  a {
    color: inherit;
    text-decoration: none;
  }
}

@layer typography {
  h1,
  h2,
  h3 {
    font-family: var(--font);
    font-weight: 700;
    line-height: var(--lh-heading);
  }

  /* Legacy .label (section labels above h2) — converted to genuine small caps */
  .label {
    font-family: var(--font-nav-caps);
    font-variant: normal;
    font-size: var(--smaller);
    font-weight: 400;
    letter-spacing: 0.07em;
    color: var(--accent);
  }
}

@layer layout {
  .container {
    max-width: var(--max-width);
    margin: 0 auto;
    padding: 0 var(--space-6);
  }

  section {
    padding: var(--space-16) 0;
  }
}

@layer components {
  /* ========================================
     NAVIGATION
     ======================================== */
  nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: rgba(250, 249, 247, 0.92);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
    transition: var(--transition);
  }

  nav .container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 4rem; /* 64px per spec */
  }

  /* Nav name — Concourse T7 Regular, body size, anchors the page */
  .nav-logo {
    font-family: var(--font-nav);
    font-size: var(--body);
    font-weight: 400;
    font-style: normal;
    letter-spacing: 0;
    font-variant: normal;
    text-transform: none;
    color: var(--ink);
  }

  .nav-links {
    display: flex;
    gap: var(--space-5);
    list-style: none;
  }

  /* Nav links — Concourse Caps T3 Regular, lighter grade for contrast */
  .nav-links a {
    font-family: var(--font-nav-caps);
    font-size: var(--small);
    font-weight: 400;
    font-style: normal;
    letter-spacing: 0.07em;
    font-variant: normal;
    text-transform: none;
    color: var(--ink-light);
    transition: color var(--transition);
    position: relative;
  }

  .nav-links a:hover {
    color: var(--accent);
  }

  .nav-links a::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 0;
    height: 1px;
    background: var(--accent);
    transition: width var(--transition);
  }

  .nav-links a:hover::after {
    width: 100%;
  }

  /* ---- Mobile nav (sticky bottom) ---- */
  .mobile-nav {
    display: none;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: rgba(250, 249, 247, 0.95);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-top: 1px solid var(--border);
    justify-content: space-around;
    padding: 0.5rem 0;
    padding-bottom: env(safe-area-inset-bottom);
  }

  .mobile-nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.75rem;
    color: var(--ink-lighter);
    font-family: var(--font-nav-caps);
    font-variant: normal;
    font-size: 0.625rem;
    font-weight: 400;
    letter-spacing: 0.07em;
    transition: color var(--transition);
    text-decoration: none;
  }

  .mobile-nav-item svg {
    width: 20px;
    height: 20px;
  }

  .mobile-nav-item.active,
  .mobile-nav-item:hover {
    color: var(--accent);
  }

  /* ========================================
     HERO
     ======================================== */
  .hero {
    min-height: auto;
    display: flex;
    align-items: center;
    padding-top: calc(4rem + var(--space-12)); /* nav height + breathing room */
    padding-bottom: var(--space-12);
    position: relative;
  }

  .hero::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 50%;
    height: 100%;
    background: radial-gradient(ellipse at 70% 30%, var(--accent-wash) 0%, transparent 60%);
    pointer-events: none;
  }

  .hero-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-12);
    align-items: center;
  }

  /* Hero label — add breathing room before the tagline */
  .hero-text .label {
    margin-bottom: var(--space-3);
  }

  /* Hero h1 — italic, not bold; voice not structure */
  .hero-text h1 {
    font-size: var(--h1);
    font-weight: 400;
    font-style: italic;
    color: var(--ink);
    line-height: var(--lh-heading);
    max-width: 640px;
    margin-bottom: var(--space-5);
  }

  /* Hero description */
  .hero-subtitle {
    font-size: var(--body);
    color: var(--ink-light);
    line-height: var(--lh-body);
    max-width: 560px;
    margin-bottom: var(--space-8);
  }

  /* Slide deck in hero */
  .hero-visual {
    position: relative;
  }

  .slide-deck {
    background: var(--surface-elevated);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
    overflow: hidden;
    aspect-ratio: 16 / 10;
    position: relative;
  }

  .slide {
    position: absolute;
    inset: 0;
    padding: clamp(1.25rem, 4vw, 3rem);
    display: flex;
    flex-direction: column;
    justify-content: center;
    opacity: 0;
    transition: opacity 600ms ease;
    pointer-events: none;
    overflow: hidden;
  }

  .slide.active {
    opacity: 1;
    pointer-events: auto;
  }

  .slide-number {
    font-family: var(--font-nav-caps);
    font-variant: normal;
    font-size: var(--smaller);
    font-weight: 400;
    letter-spacing: 0.07em;
    color: var(--accent);
    margin-bottom: clamp(0.25rem, 1.5vw, 1rem);
    flex-shrink: 0;
  }

  .slide h2 {
    font-size: clamp(var(--smaller), 2.5vw, var(--h3));
    font-weight: 700;
    line-height: var(--lh-heading);
    margin-bottom: clamp(0.25rem, 1.5vw, 1rem);
    flex-shrink: 0;
  }

  .slide p {
    font-size: clamp(0.75rem, 1.5vw, var(--smaller));
    color: var(--ink-light);
    line-height: var(--lh-body);
    max-width: 28rem;
    opacity: 0.85;
    flex-shrink: 1;
    min-height: 0;
    overflow: hidden;
  }

  .slide-controls {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-3);
    padding: var(--space-4) 0 var(--space-2);
  }

  .slide-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--border-strong);
    border: none;
    cursor: pointer;
    transition: all var(--transition);
    padding: 0;
  }

  .slide-dot.active {
    background: var(--accent);
    width: 24px;
    border-radius: 4px;
  }

  /* Slide gradient themes */
  .slide-gradient-1 {
    background: linear-gradient(135deg, #faf9f7 0%, #f0eef8 100%);
  }

  .slide-gradient-2 {
    background: linear-gradient(135deg, var(--ink) 0%, #2a2a4e 100%);
  }
  .slide-gradient-2 h2,
  .slide-gradient-2 p,
  .slide-gradient-2 .slide-number {
    color: #fff;
  }
  .slide-gradient-2 p {
    opacity: 0.8;
  }

  .slide-gradient-3 {
    background: linear-gradient(135deg, #faf9f7 0%, #f5f0e8 100%);
  }

  /* ========================================
     SECTION HEADERS
     ======================================== */
  .section-header {
    margin-bottom: var(--space-10);
  }

  .section-header h2 {
    font-size: var(--h2);
    font-weight: 700;
    color: var(--ink);
    margin-top: var(--space-3);
  }

  .section-header p {
    font-size: var(--body);
    color: var(--ink-light);
    line-height: var(--lh-body);
    margin-top: var(--space-4);
    max-width: 560px;
  }

  /* .section-divider removed — decoration the spacing already handles */

  /* ========================================
     FEATURED WRITING
     ======================================== */
  .writing-section {
    background: var(--surface);
  }

  .writing-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(20rem, 1fr));
    gap: var(--space-6);
  }

  .article-card {
    background: var(--surface-elevated);
    border-radius: var(--radius-lg);
    padding: var(--space-6);
    border: 1px solid var(--border);
    transition: all var(--transition);
    display: flex;
    flex-direction: column;
    position: relative;
  }

  .article-card:hover {
    border-color: var(--border-strong);
    box-shadow: var(--shadow-md);
    transform: translateY(-2px);
  }

  /* Card category label — genuine small caps, no fake uppercase */
  .article-card .tag {
    font-family: var(--font-nav-caps);
    font-variant: normal;
    font-size: var(--smaller);
    font-weight: 400;
    letter-spacing: 0.07em;
    color: var(--accent);
    margin-bottom: var(--space-4);
    align-self: flex-start;
    display: inline-block;
  }

  .article-card h3 {
    font-size: var(--h3);
    font-weight: 700;
    line-height: var(--lh-heading);
    color: var(--ink);
    margin-bottom: var(--space-3);
  }

  .article-card p {
    font-size: var(--small);
    color: var(--ink-light);
    line-height: var(--lh-body);
    flex: 1;
  }

  .article-card .read-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    margin-top: var(--space-5);
    font-family: var(--font-nav-caps);
    font-size: var(--small);
    letter-spacing: 0.05em;
    color: var(--accent);
    transition: gap var(--transition);
  }

  .article-card:hover .read-link {
    gap: var(--space-3);
  }

  .article-card .read-link svg {
    width: 16px;
    height: 16px;
    transition: transform var(--transition);
  }

  .article-card:hover .read-link svg {
    transform: translateX(2px);
  }

  /* ========================================
     PROJECTS
     ======================================== */
  .projects-section {
    background: var(--ink);
    color: #fff;
    position: relative;
    overflow: hidden;
  }

  .projects-section::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -20%;
    width: 60%;
    height: 200%;
    background: radial-gradient(ellipse, rgba(91, 74, 138, 0.15) 0%, transparent 60%);
    pointer-events: none;
  }

  .projects-section .label {
    color: var(--accent-light);
  }
  .projects-section .section-header h2 {
    color: #fff;
  }
  .projects-section .section-header p {
    color: rgba(255, 255, 255, 0.6);
  }

  .project-card {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-10);
    align-items: center;
    padding: var(--space-10) 0;
    border-top: 1px solid rgba(255, 255, 255, 0.08);
  }

  .section-header + .project-card {
    border-top: none;
  }
  .project-card:nth-child(even) .project-info {
    order: 2;
  }
  .project-card:nth-child(even) .project-visual {
    order: 1;
  }

  .project-info h3 {
    font-size: var(--h3);
    font-weight: 700;
    line-height: var(--lh-heading);
    color: #fff;
    margin-bottom: var(--space-3);
  }

  .project-info .project-url {
    font-family: var(--font-nav);
    font-size: var(--small);
    color: var(--accent-light);
    margin-bottom: var(--space-5);
    display: block;
  }

  .project-info p {
    font-size: var(--small);
    color: rgba(255, 255, 255, 0.6);
    line-height: var(--lh-body);
    margin-bottom: var(--space-5);
  }

  .project-visual {
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: var(--radius-lg);
    aspect-ratio: 16 / 10;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  .project-visual img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .visit-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-5);
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: var(--radius);
    color: #fff;
    font-family: var(--font-nav);
    font-size: var(--small);
    transition: all var(--transition);
    margin-top: var(--space-5);
  }

  .visit-link:hover {
    background: rgba(255, 255, 255, 0.14);
    border-color: rgba(255, 255, 255, 0.2);
  }

  .visit-link svg {
    width: 14px;
    height: 14px;
  }

  /* ========================================
     CONNECT / FOOTER
     ======================================== */
  .connect-section {
    background: var(--surface);
    padding: var(--space-16) 0 var(--space-10);
  }

  .connect-section h2 {
    font-size: var(--h2);
    font-weight: 700;
    color: var(--ink);
    margin-bottom: var(--space-4);
  }

  .connect-section > .container > p {
    font-size: var(--body);
    color: var(--ink-light);
    line-height: var(--lh-body);
    margin-bottom: var(--space-8);
    max-width: 560px;
  }

  .social-links {
    display: flex;
    gap: var(--space-4);
    flex-wrap: wrap;
    margin-bottom: var(--space-16);
  }

  /* Professional social links */
  .social-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-5);
    border: 1px solid var(--border-strong);
    border-radius: var(--radius);
    font-family: var(--font-nav-caps);
    font-size: var(--small);
    letter-spacing: 0.05em;
    color: var(--ink-light);
    transition: all var(--transition);
  }

  .social-link:hover {
    border-color: var(--accent);
    color: var(--accent);
    background: var(--accent-wash);
  }

  .social-link svg {
    width: 16px;
    height: 16px;
  }

  /* Footer — italic, tertiary colour */
  footer {
    border-top: 1px solid var(--border);
    padding: var(--space-6) 0;
  }

  footer p {
    font-size: var(--small);
    font-style: italic;
    color: var(--ink-lighter);
  }

  footer a {
    font-style: normal;
    color: var(--ink-light);
    transition: color var(--transition);
  }

  footer a:hover {
    color: var(--accent);
  }
}

@layer utilities {
  @keyframes fadeUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-in {
    opacity: 0;
    animation: fadeUp 600ms ease forwards;
  }

  .animate-in:nth-child(1) {
    animation-delay: 100ms;
  }
  .animate-in:nth-child(2) {
    animation-delay: 200ms;
  }
  .animate-in:nth-child(3) {
    animation-delay: 300ms;
  }
  .animate-in:nth-child(4) {
    animation-delay: 400ms;
  }
  .animate-in:nth-child(5) {
    animation-delay: 500ms;
  }
  .animate-in:nth-child(6) {
    animation-delay: 600ms;
  }
}

@layer responsive {
  @media (max-width: 960px) {
    .hero-grid {
      grid-template-columns: 1fr;
      gap: var(--space-8);
    }
    .hero {
      min-height: auto;
      padding-top: 6rem;
      padding-bottom: var(--space-10);
    }
    /* Keep hero text first on mobile — slide deck follows naturally */
    .hero-visual {
      max-width: 36rem;
    }
    .project-card {
      grid-template-columns: 1fr;
    }
    .project-card:nth-child(even) .project-info {
      order: 0;
    }
    .project-card:nth-child(even) .project-visual {
      order: 0;
    }
  }

  @media (max-width: 768px) {
    .nav-links {
      display: none;
    }
    section {
      padding: var(--space-12) 0;
    }
    .container {
      padding: 0 var(--space-4);
    }
    .slide-deck {
      aspect-ratio: 4 / 3;
      max-height: 50vh;
    }
    .slide p {
      display: -webkit-box;
      -webkit-line-clamp: 4;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .mobile-nav {
      display: flex;
    }
    /* Add bottom padding so mobile nav doesn't obscure content */
    body {
      padding-bottom: 4rem;
    }
  }

  @media (max-width: 480px) {
    .slide-deck {
      aspect-ratio: auto;
      max-height: 44vh;
    }
    .slide p {
      -webkit-line-clamp: 3;
    }
    .writing-grid {
      grid-template-columns: 1fr;
    }
    .social-links {
      flex-direction: column;
    }
  }
}
